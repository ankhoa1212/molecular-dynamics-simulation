LAMMPS (29 Aug 2024 - Update 1)
  using 4 OpenMP thread(s) per MPI task
# LAMMPS Input Script: Set velocity to zero for atoms entering a center region

# --- Initialization ---
units lj          # Use Lennard-Jones units
atom_style ellipsoid
dimension 3       # 3D simulation
boundary f f p    # Set boundary conditions: fixed (non-periodic) in x and y, periodic in z (standard for 2D)

# --- System Definition ---
variable box_size equal 200
variable half_box equal ${box_size}/2
variable half_box equal 200/2
region box block 0 ${box_size} 0 ${box_size} -0.5 0.5 units box # Define simulation box boundaries
region box block 0 200 0 ${box_size} -0.5 0.5 units box 
region box block 0 200 0 200 -0.5 0.5 units box 
create_box 1 box                     # Create the simulation box with 1 atom type
Created orthogonal box = (0 0 -0.5) to (200 200 0.5)
  1 by 1 by 1 MPI processor grid

create_atoms 1 random 100 12345 NULL overlap 3.9 maxtry 50
Created 100 atoms
  using lattice units in orthogonal box = (0 0 -0.5) to (200 200 0.5)
  create_atoms CPU = 0.006 seconds

region light block 90 110 90 110 -0.5 0.5	# Specify region where molecules should slow
group lit region light
1 atoms in group lit

# Set ellipsoid shape
# This sets the semi-axes lengths for a sphere
set type 1 shape 0.5 0.5 0.5
Setting atom values ...
  100 settings made for shape

set atom 1 mass 1.0                           # Set mass of atom type 1
Setting atom values ...
  1 settings made for mass

# --- Variables ---
variable x_center equal ${half_box}         # x-coordinate of the center
variable x_center equal 100         
variable y_center equal ${half_box}         # y-coordinate of the center
variable y_center equal 100         
variable vel_scale equal 10              # Scaling factor for initial velocity magnitude (adjust if needed)

# --- Interactions ---
pair_style lj/cut 2.5
pair_coeff 1 1 1.0 1.0 2.5

# --- Initial Velocities --
variable vx_init atom v_vel_scale*(${x_center}-x)
variable vx_init atom v_vel_scale*(100-x)
variable vy_init atom v_vel_scale*(${y_center}-y)
variable vy_init atom v_vel_scale*(100-y)
variable vx_slowed atom v_vel_scale*(${x_center}-x)^(0.5)
variable vx_slowed atom v_vel_scale*(100-x)^(0.5)
variable vy_slowed atom v_vel_scale*(${y_center}-y)^(0.5)
variable vy_slowed atom v_vel_scale*(100-y)^(0.5)
# Apply the calculated velocities to all atoms, initializing at zero total linear momentum
velocity all set v_vx_init v_vy_init 0.0 sum yes
# Slow molecules in the light region
velocity lit set v_vx_slowed v_vy_slowed 0.0 sum yes


# --- Integration ---
fix 1 all nve
fix 2 all langevin 5.0 0.1 1.0 48279 angmom 3.333

# --- Simulation Settings ---
timestep 0.00001 # Timestep for integration (in lj time units) - Keep it small for stability
thermo 100     # Output thermodynamic info every 100 steps
thermo_style custom step temp pe ke etotal press vol atoms # Added 'atoms' to check count

# --- Output ---
# Dump atom positions and velocities every 100 steps to log.lammpstrj file
# Removed damping-related variables from dump
dump 1 all custom 100 central2.in.lammpstrj id type x y vx vy fx fy

# --- Run Simulation ---
run 100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 143 143 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 9.665 | 9.665 | 9.665 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Atoms   
         0  -nan           -0.061523437   -nan           -nan           -nan            40000                100 
ERROR on proc 0: Non-numeric atom coords - simulation unstable (src/domain.cpp:790)
Last command: run 100000
