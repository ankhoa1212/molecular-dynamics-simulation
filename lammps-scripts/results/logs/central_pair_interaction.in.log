LAMMPS (29 Aug 2024 - Update 1)
  using 4 OpenMP thread(s) per MPI task
# LAMMPS Input Script: Gradually lower velocity for atoms closer to the center

# --- Initialization ---
units lj          # Use Lennard-Jones units
atom_style ellipsoid
dimension 3       # 3D simulation
boundary f f p    # set boundary conditions: fixed (non-periodic) in x and y, periodic in z (standard for 2D)

# --- Define the box for the simulation ---
variable box_size equal 200
variable half_box equal ${box_size}/2
variable half_box equal 200/2
region box block 0 ${box_size} 0 ${box_size} -0.5 0.5 units box # Define simulation box boundaries
region box block 0 200 0 ${box_size} -0.5 0.5 units box 
region box block 0 200 0 200 -0.5 0.5 units box 
create_box 1 box                # create the simulation box with 1 atom type
Created orthogonal box = (0 0 -0.5) to (200 200 0.5)
  1 by 1 by 1 MPI processor grid
create_atoms 1 random ${molecules} 12345 NULL overlap 3.9 maxtry 50
create_atoms 1 random 1000 12345 NULL overlap 3.9 maxtry 50
Created 1000 atoms
  using lattice units in orthogonal box = (0 0 -0.5) to (200 200 0.5)
  create_atoms CPU = 0.014 seconds

# --- Define the variables for lj/expand ---
variable	epsilon equal ${var_epsilon}	# energy (strength of attraction between particles)
variable	epsilon equal 0.0	
variable	sigma equal 1.0     # distance where particles bond (potential energy is 0)
variable	delta equal 0.0     # radius difference between particles (for lj/expand)
variable	cutoff equal 2.0	# cutoff distance (particles farther than this value have the interaction ignored)

# Set ellipsoid as a sphere
set type 1 shape 0.5 0.5 0.5
Setting atom values ...
  1000 settings made for shape
set atom 1 mass 1.0             # set mass of atom type 1
Setting atom values ...
  1 settings made for mass

# --- Other variables ---
variable center_x equal ${half_box}
variable center_x equal 100
variable center_y equal ${half_box}
variable center_y equal 100
variable vel_scale equal 9      # scaling factor for initial velocity magnitude (adjust if needed)
variable dist atom sqrt((x-${center_x})^2+(y-${center_y})^2)
variable dist atom sqrt((x-100)^2+(y-${center_y})^2)
variable dist atom sqrt((x-100)^2+(y-100)^2)

# --- Interactions ---
pair_style lj/expand 2.5
pair_coeff 1 1 ${epsilon} ${sigma} ${delta} ${cutoff}
pair_coeff 1 1 0 ${sigma} ${delta} ${cutoff}
pair_coeff 1 1 0 1 ${delta} ${cutoff}
pair_coeff 1 1 0 1 0 ${cutoff}
pair_coeff 1 1 0 1 0 2

# --- Initial Velocities ---
variable vx_init atom v_vel_scale*(${half_box}-x)
variable vx_init atom v_vel_scale*(100-x)
variable vy_init atom v_vel_scale*(${half_box}-y)
variable vy_init atom v_vel_scale*(100-y)
# Apply the calculated velocities to all atoms, initialize @ zero total linear momentum
velocity all set v_vx_init v_vy_init 0.0 sum yes

# --- Integration ---
fix 1 all nve
fix 2 all langevin 5.0 0.1 0.1 48279

# --- Simulation Settings ---
timestep 0.0001 # timestep for integration (in lj time units) - Keep it small for stability
thermo 100      # output thermodynamic info every 100 steps
thermo_style custom step temp pe ke etotal press vol atoms  # Added 'atoms' to check count

# --- Output ---
# dump atom positions and velocities every 100 steps to a .lammpstrj file
dump 1 all custom 100 ${filename}.lammpstrj id type x y vx vy fx fy v_dist
dump 1 all custom 100 central_pair_interaction.in_1000_0.0.lammpstrj id type x y vx vy fx fy v_dist

# --- Run Simulation ---
run 15000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.3
  ghost atom cutoff = 2.3
  binsize = 1.15, bins = 174 174 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/expand, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 10.36 | 10.36 | 10.36 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Atoms   
         0   179964.67      0              269677.07      269677.07      4494.6178      40000               1000 
       100   147324.39      0              220765.6       220765.6       3679.4267      40000               1000 
       200   120608.16      0              180731.33      180731.33      3012.1888      40000               1000 
       300   98745.853      0              147970.66      147970.66      2466.1777      40000               1000 
       400   80833.906      0              121129.61      121129.61      2018.8268      40000               1000 
       500   66179.242      0              99169.594      99169.594      1652.8266      40000               1000 
       600   54183.467      0              81193.925      81193.925      1353.2321      40000               1000 
       700   44361.941      0              66476.368      66476.368      1107.9395      40000               1000 
       800   36316.899      0              54420.873      54420.873      907.01456      40000               1000 
       900   29727.824      0              44547.144      44547.144      742.4524       40000               1000 
      1000   24326.25       0              36452.886      36452.886      607.5481       40000               1000 
      1100   19916.429      0              29844.769      29844.769      497.41282      40000               1000 
      1200   16308.895      0              24438.879      24438.879      407.31464      40000               1000 
      1300   13353.281      0              20009.891      20009.891      333.49818      40000               1000 
      1400   10936.041      0              16387.658      16387.658      273.12763      40000               1000 
      1500   8958.1101      0              13423.728      13423.728      223.7288       40000               1000 
      1600   7333.3458      0              10989.019      10989.019      183.15031      40000               1000 
      1700   6006.3022      0              9000.4439      9000.4439      150.0074       40000               1000 
      1800   4921.8005      0              7375.318       7375.318       122.92197      40000               1000 
      1900   4030.6479      0              6039.9258      6039.9258      100.66543      40000               1000 
      2000   3302.5689      0              4948.8995      4948.8995      82.481659      40000               1000 
      2100   2704.6732      0              4052.9528      4052.9528      67.549214      40000               1000 
      2200   2215.8511      0              3320.4529      3320.4529      55.340881      40000               1000 
      2300   1815.2042      0              2720.0835      2720.0835      45.334726      40000               1000 
      2400   1486.6633      0              2227.765       2227.765       37.129416      40000               1000 
      2500   1220.257       0              1828.5552      1828.5552      30.475919      40000               1000 
      2600   997.68416      0              1495.0297      1495.0297      24.917162      40000               1000 
      2700   817.12053      0              1224.4551      1224.4551      20.407585      40000               1000 
      2800   669.48522      0              1003.2236      1003.2236      16.720393      40000               1000 
      2900   549.19675      0              822.97133      822.97133      13.716189      40000               1000 
      3000   450.50057      0              675.07511      675.07511      11.251252      40000               1000 
      3100   369.20931      0              553.26015      553.26015      9.2210025      40000               1000 
      3200   302.68271      0              453.57004      453.57004      7.5595007      40000               1000 
      3300   249.1969       0              373.42155      373.42155      6.2236925      40000               1000 
      3400   205.18993      0              307.47711      307.47711      5.1246186      40000               1000 
      3500   168.80046      0              252.94748      252.94748      4.2157914      40000               1000 
      3600   138.70468      0              207.84896      207.84896      3.4641493      40000               1000 
      3700   114.65893      0              171.8164       171.8164       2.8636067      40000               1000 
      3800   94.696809      0              141.90317      141.90317      2.3650528      40000               1000 
      3900   78.039734      0              116.94254      116.94254      1.9490424      40000               1000 
      4000   64.369053      0              96.457027      96.457027      1.6076171      40000               1000 
      4100   53.373688      0              79.980471      79.980471      1.3330079      40000               1000 
      4200   44.337194      0              66.439286      66.439286      1.1073214      40000               1000 
      4300   36.598978      0              54.843569      54.843569      0.91405948     40000               1000 
      4400   30.633569      0              45.904403      45.904403      0.76507339     40000               1000 
      4500   25.87345       0              38.771365      38.771365      0.64618942     40000               1000 
      4600   21.954836      0              32.899322      32.899322      0.54832203     40000               1000 
      4700   18.523979      0              27.758183      27.758183      0.46263638     40000               1000 
      4800   15.864086      0              23.772333      23.772333      0.39620555     40000               1000 
      4900   13.873856      0              20.789972      20.789972      0.34649954     40000               1000 
      5000   11.934445      0              17.883766      17.883766      0.29806276     40000               1000 
      5100   10.338176      0              15.491757      15.491757      0.25819595     40000               1000 
      5200   8.989922       0              13.471398      13.471398      0.2245233      40000               1000 
      5300   7.8123513      0              11.706808      11.706808      0.19511347     40000               1000 
      5400   6.8390801      0              10.248362      10.248362      0.17080603     40000               1000 
      5500   6.1981689      0              9.2879562      9.2879562      0.15479927     40000               1000 
      5600   5.6757718      0              8.505144       8.505144       0.1417524      40000               1000 
      5700   5.1490271      0              7.715817       7.715817       0.12859695     40000               1000 
      5800   4.7987176      0              7.1908783      7.1908783      0.11984797     40000               1000 
      5900   4.5376745      0              6.7997052      6.7997052      0.11332842     40000               1000 
      6000   4.3142248      0              6.4648659      6.4648659      0.10774776     40000               1000 
      6100   4.0376828      0              6.0504677      6.0504677      0.10084113     40000               1000 
      6200   3.8199061      0              5.7241293      5.7241293      0.095402155    40000               1000 
      6300   3.7143807      0              5.5659995      5.5659995      0.092766658    40000               1000 
      6400   3.6146637      0              5.4165735      5.4165735      0.090276225    40000               1000 
      6500   3.4811591      0              5.2165169      5.2165169      0.086941949    40000               1000 
      6600   3.3608384      0              5.0362163      5.0362163      0.083936938    40000               1000 
      6700   3.2690984      0              4.898744       4.898744       0.081645733    40000               1000 
      6800   3.2123781      0              4.8137486      4.8137486      0.080229143    40000               1000 
      6900   3.0433405      0              4.5604458      4.5604458      0.07600743     40000               1000 
      7000   2.9711165      0              4.452218       4.452218       0.074203634    40000               1000 
      7100   2.9108633      0              4.3619286      4.3619286    