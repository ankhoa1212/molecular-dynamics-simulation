LAMMPS (29 Aug 2024 - Update 1)
  using 4 OpenMP thread(s) per MPI task
# LAMMPS Input Script: Gradually lower velocity for atoms closer to the center

# --- Initialization ---
units lj          # Use Lennard-Jones units
atom_style ellipsoid
dimension 3       # 3D simulation
boundary f f p    # set boundary conditions: fixed (non-periodic) in x and y, periodic in z (standard for 2D)

# --- Define the box for the simulation ---
variable box_size equal 200
variable half_box equal ${box_size}/2
variable half_box equal 200/2
region box block 0 ${box_size} 0 ${box_size} -0.5 0.5 units box # Define simulation box boundaries
region box block 0 200 0 ${box_size} -0.5 0.5 units box 
region box block 0 200 0 200 -0.5 0.5 units box 
create_box 1 box                # create the simulation box with 1 atom type
Created orthogonal box = (0 0 -0.5) to (200 200 0.5)
  1 by 1 by 1 MPI processor grid
create_atoms 1 random ${molecules} 12345 NULL overlap 3.9 maxtry 50
create_atoms 1 random 1000 12345 NULL overlap 3.9 maxtry 50
Created 1000 atoms
  using lattice units in orthogonal box = (0 0 -0.5) to (200 200 0.5)
  create_atoms CPU = 0.017 seconds

# --- Define the variables for lj/expand ---
variable	epsilon equal ${var_epsilon}	# energy (strength of attraction between particles)
variable	epsilon equal 10.0	
variable	sigma equal 1.0     # distance where particles bond (potential energy is 0)
variable	delta equal 0.0     # radius difference between particles (for lj/expand)
variable	cutoff equal 2.0	# cutoff distance (particles farther than this value have the interaction ignored)

# Set ellipsoid as a sphere
set type 1 shape 0.5 0.5 0.5
Setting atom values ...
  1000 settings made for shape
set atom 1 mass 1.0             # set mass of atom type 1
Setting atom values ...
  1 settings made for mass

# --- Other variables ---
variable center_x equal ${half_box}
variable center_x equal 100
variable center_y equal ${half_box}
variable center_y equal 100
variable vel_scale equal 9      # scaling factor for initial velocity magnitude (adjust if needed)
variable dist atom sqrt((x-${center_x})^2+(y-${center_y})^2)
variable dist atom sqrt((x-100)^2+(y-${center_y})^2)
variable dist atom sqrt((x-100)^2+(y-100)^2)

# --- Interactions ---
pair_style lj/expand 2.5
pair_coeff 1 1 ${epsilon} ${sigma} ${delta} ${cutoff}
pair_coeff 1 1 10 ${sigma} ${delta} ${cutoff}
pair_coeff 1 1 10 1 ${delta} ${cutoff}
pair_coeff 1 1 10 1 0 ${cutoff}
pair_coeff 1 1 10 1 0 2

# --- Initial Velocities ---
variable vx_init atom v_vel_scale*(${half_box}-x)
variable vx_init atom v_vel_scale*(100-x)
variable vy_init atom v_vel_scale*(${half_box}-y)
variable vy_init atom v_vel_scale*(100-y)
# Apply the calculated velocities to all atoms, initialize @ zero total linear momentum
velocity all set v_vx_init v_vy_init 0.0 sum yes

# --- Integration ---
fix 1 all nve
fix 2 all langevin 5.0 0.1 0.1 48279

# --- Simulation Settings ---
timestep 0.0001 # timestep for integration (in lj time units) - Keep it small for stability
thermo 100      # output thermodynamic info every 100 steps
thermo_style custom step temp pe ke etotal press vol atoms  # Added 'atoms' to check count

# --- Output ---
# dump atom positions and velocities every 100 steps to a .lammpstrj file
dump 1 all custom 100 ${filename}.lammpstrj id type x y vx vy fx fy v_dist
dump 1 all custom 100 central_pair_interaction.in_1000_10.0.lammpstrj id type x y vx vy fx fy v_dist

# --- Run Simulation ---
run 15000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.3
  ghost atom cutoff = 2.3
  binsize = 1.15, bins = 174 174 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/expand, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 10.36 | 10.36 | 10.36 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Atoms   
         0   179964.67     -0.035068359    269677.07      269677.03      4496.616       40000               1000 
       100   147324.39     -0.079980469    220765.6       220765.52      3681.4228      40000               1000 
       200   120608.16     -0.081210937    180731.33      180731.25      3014.1848      40000               1000 
       300   98745.853     -0.065830078    147970.66      147970.6       2468.1745      40000               1000 
       400   80833.906     -0.065830078    121129.61      121129.54      2020.8236      40000               1000 
       500   66179.242     -0.075673828    99169.594      99169.519      1654.8229      40000               1000 
       600   54183.467     -0.084287109    81193.925      81193.841      1355.2279      40000               1000 
       700   44361.941     -0.069860459    66476.368      66476.299      1109.936       40000               1000 
       800   36316.907     -0.13735185     54420.885      54420.748      909.00801      40000               1000 
       900   29727.873     -0.31198233     44547.218      44546.906      744.43844      40000               1000 
      1000   24326.415     -0.69999878     36453.134      36452.434      609.51868      40000               1000 
      1100   19916.821     -1.3236844      29845.357      29844.033      499.36146      40000               1000 
      1200   16309.648     -2.3164407      24440.007      24437.691      409.23662      40000               1000 
      1300   13354.366     -3.4176706      20011.518      20008.1        335.4277       40000               1000 
      1400   10937.606     -4.8156178      16390.002      16385.187      275.08429      40000               1000 
      1500   8960.299      -6.6282182      13427.008      13420.38       225.71573      40000               1000 
      1600   7335.9424     -8.3825109      10992.91       10984.527      185.23701      40000               1000 
      1700   6009.1512     -9.9310131      9004.713       8994.782       152.27016      40000               1000 
      1800   4924.7525     -11.281359      7379.7416      7368.4602      125.41042      40000               1000 
      1900   4034.3608     -13.778518      6045.4896      6031.7111      103.27117      40000               1000 
      2000   3306.7365     -15.964846      4955.1446      4939.1798      85.240789      40000               1000 
      2100   2707.7719     -17.044361      4057.5962      4040.5519      70.588586      40000               1000 
      2200   2217.7761     -17.052117      3323.3375      3306.2854      58.797513      40000               1000 
      2300   1818.4571     -19.468855      2724.9579      2705.4891      49.007866      40000               1000 
      2400   1488.5728     -20.208826      2230.6264      2210.4176      41.195036      40000               1000 
      2500   1221.5241     -19.650717      1830.4538      1810.8031      35.152017      40000               1000 
      2600   998.51079     -18.757682      1496.2684      1477.5107      30.29188       40000               1000 
      2700   813.40829     -12.395904      1218.8923      1206.4964      27.02091       40000               1000 
      2800   664.999       -10.384162      996.50101      986.11685      24.141624      40000               1000 
      2900   541.31424     -4.1118183      811.15939      807.04757      22.412799      40000               1000 
      3000   437.29653      5.4781135      655.28885      660.76696      21.588475      40000               1000 
      3100   349.71277      19.537428      524.04459      543.58202      21.671197      40000               1000 
      3200   280.02441      29.949745      419.61658      449.56633      21.738554      40000               1000 
      3300   220.58158      46.392155      330.5415       376.93365      22.666563      40000               1000 
      3400   172.03356      61.922117      257.7923       319.71441      23.707204      40000               1000 
      3500   136.10209      70.693441      203.94897      274.64242      933      40000               1000 
      3600   104.99557      83.808304      157.33587      241.14417      24.045631      40000               1000 
      3700   81.962206      92.0185        122.82037      214.83887      24.639024      40000               1000 
      3800   65.685493      95.33541       98.429712      193.76512      24.811086      40000               1000 
      3900   54.342189      95.551533      81.43177       176.9833       24.654621      40000               1000 
      4000   48.939         89.336707      73.335092      162.6718       23.878605      40000               1000 
      4100   45.072791      82.573208      67.541578      150.11479      23.013068      40000               1000 
      4200   43.867418      72.179324      65.735326      137.91465      21.754647      40000               1000 
      4300   42.829581      62.05411       64.180127      126.23424      20.490753      40000               1000 
      4400   42.751399      49.97611       64.062971      114.03908      18.982954      40000               1000 
      4500   42.935173      38.145815      64.338357      102.48417      17.481764      40000               1000 
      4600   42.353523      26.795109      63.466755      90.261864      15.98849       40000               1000 
      4700   41.874761      15.783407      62.749329      78.532737      14.498583      40000               1000 
      4800   40.637603      6.3336404      60.895448      67.229089      13.148583      40000               1000 
      4900   39.000646     -2.1854828      58.442468      56.256985      11.892725      40000               1000 
      5000   37.121912     -9.2938228      55.627185      46.333363      10.799369      40000               1000 
      5100   34.93779      -15.414107      52.354279      36.940172      9.8148106      40000               1000 
      5200   32.938573     -21.521458      49.358452      27.836993      8.8319544      40000               1000 
      5300   30.717386     -26.066721      46.030003      19.963282      8.0389327      40000               1000 
      5400   28.210376     -30.108191      42.273249      12.165058      7.3041765      40000               1000 
      5500   25.800839     -33.479233      38.662557      5.183324       6.655491       40000               1000 
      5600   23.496363     -35.95756       35.2093       -0.74825976     6.1171903      40000               1000 
      5700   21.401917     -38.387614      32.070772     -6.3168423      5.6024044      40000               1000 
      5800   19.333577     -40.337633      28.971365     -11.366268      5.1577848      40000               1000 
      5900   17.288002     -41.96729       25.906072     -16.061218      4.7678763      40000               1000 
      6000   15.475688     -43.325947      23.190318     -20.135629      4.4292915      40000               1000 
      6100   14.032923     -44.641859      21.028335     -23.613525      4.1093586      40000               1000 
      6200   12.757872     -45.563768      19.117672     -26.446097      3.8467968      40000               1000 
      6300   11.542284     -46.424817      17.296112     -29.128705      3.5985776      40000               1000 
      6400   10.33704      -46.881733      15.490054     -31.391679      3.4095813      40000               1000 
      6500   9.4316871     -47.422044      14.133383     -33.288661      3.2271565      40000               1000 
      6600   8.7008436     -48.055358      13.038214     -35.017144      3.0492178      40000               1000 
      6700   7.8930138     -48.36183       11.827681     -36.534149      2.9163559      40000               1000 
      6800   7.1223541     -48.504273      10.672848     -37.831425      2.8159674      40000               1000 
      6900   6.5917916     -48.780402      9.8777997     -38.902603      2.7105778      40000               1000 
      7000   5.9984783     -49.001294      8.9887197     -40.012574      2.6132609      40000               1000 
      7100   5.5937217     -49.195103      8.3821919     -40.812911      2.5287422      40000               1000 
      7200   5.2871629     -49.486433      7.9228136     -41.563619      2.4396803      40000               1000 
      7300   4.7947771     -49.547873      7.1849735     -42.362899      2.3773205      40000               1000 
      7400   4.448479      -49.662931      6.6660458     -42.996886      2.3162429      40000               1000 
      7500   4.2027303     -49.814491      6.2977913     -43.5167        2.2554451      40000               1000 
      7600   4.016702      -49.950378      6.019028      -43.931351      2.2039535      40000               1000 
      7700   3.9213728     -50.140303      5.8761771     -44.264126      2.1492182      40000               1000 
      7800   3.6261829     -50.099013      5.4338352     -44.665178      2.118343       40000               1000 
      7900   3.4304325     -50.06787       5.1405031     -44.927367      2.0906464      40000               1000 
      8000   3.413324      -50.281248      5.114866      -45.166381      2.0385244      40000               1000 
      8100   3.2835906     -50.395877      4.9204606     -45.475417      2.001091       40000               1000 
      8200   3.029092      -50.325206      4.5390943     -45.786112      1.9852604      40000               1000 
      8300   2.8888402     -50.298737      4.3289271     -45.96981       1.9694752      40000               1000 
      8400   2.839388      -50.389435      4.2548229     -46.134613      1.9387433      40000               1000 
      8500   2.8468543     -50.512317      4.2660111     -46.246306      1.9076111      40000               1000 
      8600   2.7273049     -50.566161      4.0868663     -46.479295      1.8823661      40000               1000 
      8700   2.7242724     -50.708257      4.0823221     -46.625935      1.8516725      40000               1000 
      8800   2.6618737     -50.741525      3.9888178     -46.752707      1.8333867      40000               1000 
      8900   2.5372648     -50.645601      3.8020914     -46.843509      1.8362744      40000               1000 
      9000   2.4414982     -50.597039      3.6585851     -46.938454      1.833792       40000               1000 
      9100   2.3988187     -50.66887       3.5946298     -47.07424       1.8173744      40000               1000 
      9200   2.3381249     -50.669903      3.5036802     -47.166223      1.8098821      40000               1000 
      9300   2.2407783     -50.701496      3.3578062     -47.34369       1.7992821      40000               1000 
      9400   2.2847619     -50.835522      3.4237157     -47.411806      1.7793257      40000               1000 
      9500   2.3228066     -50.936385      3.4807257     -47.45566       1.7638207      40000               1000 
      9600   2.2116987     -50.905222      3.3142306     -47.590991      1.7634137      40000               1000 
      9700   2.1597764     -50.874912      3.236425      -47.638487      1.7648066      40000               1000 
      9800   2.1648168     -50.944469      3.243978      -47.700491      1.7534347      40000               1000 
      9900   2.1341191     -51.013327      3.1979775     -47.815349      1.739951       40000               1000 
     10000   2.1000905     -51.113373      3.1469856     -47.966387      1.7221647      40000               1000 
     10100   2.0963337     -51.230721      3.141356      -48.089365      1.7027789      40000               1000 
     10200   2.0743129     -51.306681      3.1083579     -48.198323      1.6875234      40000               1000 
     10300   2.0278787     -51.367752      3.0387763     -48.328976      1.6790546      40000               1000 
     10400   1.9892844     -51.391903      2.9809427     -48.41096       1.6765224      40000               1000 
     10500   1.9545933     -51.438684      2.928958      -48.509726      1.6698387      40000               1000 
     10600   1.9211418     -51.494486      2.878831      -48.615655      1.663258       40000               1000 
     10700   1.8360302     -51.5417        2.7512912     -48.790409      1.6536855      40000               1000 
     10800   1.8153046     -51.575682      2.7202339     -48.855448      1.6452458      40000               1000 
     10900   1.7903914     -51.623346      2.6829015     -48.940445      1.6382455      40000               1000 
     11000   1.755004      -51.701516      2.6298734     -49.071642      1.6286961      40000               1000 
     11100   1.7185914     -51.732427      2.5753092     -49.157117      1.6207047      40000               1000 
     11200   1.68051       -51.764655      2.5182443     -49.246411      1.6152543      40000               1000 
     11300   1.6284535     -51.809133      2.4402375     -49.368895      1.6058046      40000               1000 
     11400   1.6423383     -51.902278      2.461044      -49.441234      1.5934769      40000               1000 
     11500   1.6027776     -51.91292       2.4017622     -49.511158      1.5901629      40000               1000 
     11600   1.5714999     -51.926658      2.3548925     -49.571766      1.5900976      40000               1000 
     11700   1.4687256     -51.93762       2.2008853     -49.736735      1.5901991      40000               1000 
     11800   1.4636764     -51.988864      2.1933191     -49.795545      1.5867061      40000               1000 
     11900   1.4671124     -52.097036      2.198468      -49.898568      1.5759003      40000               1000 
     12000   1.4517794     -52.158421      2.1754915     -49.98293       1.5651343      40000               1000 
     12100   1.40263       -52.259608      2.1018411     -50.157767      1.5545384      40000               1000 
     12200   1.3840365     -52.293656      2.0739788     -50.219678      1.5507194      40000               1000 
     12300   1.3800758     -52.344201      2.0680436     -50.276158      1.5455345      40000               1000 
     12400   1.32812       -52.39344       1.9901878     -50.403252      1.5389549      40000               1000 
     12500   1.2864136     -52.450176      1.9276908     -50.522486      1.5352243      40000               1000 
     12600   1.2551445     -52.519547      1.880834      -50.638713      1.5285933      40000               1000 
     12700   1.235083      -52.604214      1.8507719     -50.753442      1.517257       40000               1000 
     12800   1.2115061     -52.697912      1.8154419     -50.88247       1.5059755      40000               1000 
     12900   1.1415276     -52.757736      1.710579      -51.047157      1.4979825      40000               1000 
     13000   1.1122409     -52.821029      1.6666929     -51.154337      1.4911213      40000               1000 
     13100   1.0734536     -52.904927      1.6085702     -51.296357      1.4816034      40000               1000 
     13200   1.0527231     -52.985797      1.5775055     -51.408291      1.4737849      40000               1000 
     13300   1.0043935     -53.027825      1.5050837     -51.522741      1.4692487      40000               1000 
     13400   0.96945217    -53.091973      1.4527241     -51.639249      1.4639171      40000               1000 
     13500   0.94610572    -53.181448      1.4177394     -51.763709      1.454696       40000               1000 
     13600   0.92737751    -53.280096      1.3896752     -51.890421      1.4417163      40000               1000 
     13700   0.90256746    -53.368045      1.3524973     -52.015548      1.4315766      40000               1000 
     13800   0.85895252    -53.403311      1.2871403     -52.116171      1.4292172      40000               1000 
     13900   0.81112917    -53.424527      1.2154771     -52.20905       1.4277541      40000               1000 
     14000   0.77945386    -53.501622      1.1680116     -52.33361       1.4206903      40000               1000 
     14100   0.75179535    -53.563923      1.1265653     -52.437357      1.4143856      40000               1000 
     14200   0.71321609    -53.601607      1.0687543     -52.532853      1.4125785      40000               1000 
     14300   0.67444654    -53.663152      1.0106581     -52.652494      1.4100667      40000               1000 
     14400   0.64741685    -53.719761      0.97015415    -52.749607      1.4062093      40000               1000 
     14500   0.62987121    -53.825862      0.94386201    -52.882         1.3984332      40000               1000 
     14600   0.60787888    -53.918469      0.91090651    -53.007563      1.3934185      40000               1000 
     14700   0.56981421    -53.973149      0.85386659    -53.119282      1.393284       40000               1000 
     14800   0.51951346    -54.012404      0.77849092    -53.233913      1.3945802      40000               1000 
     14900   0.47459588    -54.076786      0.71118192    -53.365604      1.3930849      40000               1000 
     15000   0.45155671    -54.149836      0.67665773    -53.473178      1.3886132      40000               1000 
Loop time of 12.1771 on 4 procs for 15000 steps with 1000 atoms

Performance: 10642.913 tau/day, 1231.819 timesteps/s, 1.232 Matom-step/s
99.4% CPU use with 1 MPI tasks x 4 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.1435     | 7.1435     | 7.1435     |   0.0 | 58.66
Neigh   | 0.86006    | 0.86006    | 0.86006    |   0.0 |  7.06
Comm    | 2.167      | 2.167      | 2.167      |   0.0 | 17.80
Output  | 0.68564    | 0.68564    | 0.68564    |   0.0 |  5.63
Modify  | 1.0865     | 1.0865     | 1.0865     |   0.0 |  8.92
Other   |            | 0.2345     |            |       |  1.93

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:           4599 ave        4599 max        4599 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:          26132 ave       26132 max       26132 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 26132
Ave neighs/atom = 26.132
Neighbor list builds = 749
Dangerous builds = 0
Total wall time: 0:00:12
0:12
