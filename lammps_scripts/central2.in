# LAMMPS Input Script: Set velocity to zero for atoms entering a center region

# --- Initialization ---
units lj          # Use Lennard-Jones units
atom_style ellipsoid
dimension 3       # 3D simulation
boundary f f p    # Set boundary conditions: fixed (non-periodic) in x and y, periodic in z (standard for 2D)

# --- System Definition ---
variable box_size equal 200
variable half_box equal ${box_size}/2
region box block 0 ${box_size} 0 ${box_size} -0.5 0.5 units box # Define simulation box boundaries
create_box 1 box                     # Create the simulation box with 1 atom type

create_atoms 1 random 100 12345 NULL overlap 3.9 maxtry 50

region light block 90 110 90 110 -0.5 0.5	# Specify region where molecules should slow
group lit region light

# Set ellipsoid shape
# This sets the semi-axes lengths for a sphere
set type 1 shape 0.5 0.5 0.5

set atom 1 mass 1.0                           # Set mass of atom type 1

# --- Variables ---
variable x_center equal ${half_box}         # x-coordinate of the center
variable y_center equal ${half_box}         # y-coordinate of the center
variable vel_scale equal 10              # Scaling factor for initial velocity magnitude (adjust if needed)

# --- Interactions ---
pair_style lj/cut 2.5
pair_coeff 1 1 1.0 1.0 2.5

# --- Initial Velocities --
variable vx_init atom v_vel_scale*(${x_center}-x)
variable vy_init atom v_vel_scale*(${y_center}-y)
variable vx_slowed atom v_vel_scale*(${x_center}-x)^(0.5)
variable vy_slowed atom v_vel_scale*(${y_center}-y)^(0.5)
# Apply the calculated velocities to all atoms, initializing at zero total linear momentum
velocity all set v_vx_init v_vy_init 0.0 sum yes
# Slow molecules in the light region
velocity lit set v_vx_slowed v_vy_slowed 0.0 sum yes 


# --- Integration ---
fix 1 all nve
fix 2 all langevin 5.0 0.1 1.0 48279 angmom 3.333

# --- Simulation Settings ---
timestep 0.00001 # Timestep for integration (in lj time units) - Keep it small for stability
thermo 100     # Output thermodynamic info every 100 steps
thermo_style custom step temp pe ke etotal press vol atoms # Added 'atoms' to check count

# --- Output ---
# Dump atom positions and velocities every 100 steps to log.lammpstrj file
# Removed damping-related variables from dump
dump 1 all custom 100 central2.in.lammpstrj id type x y vx vy fx fy

# --- Run Simulation ---
run 100000
