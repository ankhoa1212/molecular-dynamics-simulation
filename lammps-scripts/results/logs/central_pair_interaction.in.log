LAMMPS (29 Aug 2024 - Update 1)
  using 4 OpenMP thread(s) per MPI task
# LAMMPS Input Script: Gradually lower velocity for atoms closer to the center

# --- Initialization ---
units lj          # Use Lennard-Jones units
atom_style ellipsoid
dimension 3       # 3D simulation
boundary f f p    # set boundary conditions: fixed (non-periodic) in x and y, periodic in z (standard for 2D)

# --- Define the box for the simulation ---
variable box_size equal 200
variable half_box equal ${box_size}/2
variable half_box equal 200/2
region box block 0 ${box_size} 0 ${box_size} -0.5 0.5 units box # Define simulation box boundaries
region box block 0 200 0 ${box_size} -0.5 0.5 units box 
region box block 0 200 0 200 -0.5 0.5 units box 
create_box 1 box                # create the simulation box with 1 atom type
Created orthogonal box = (0 0 -0.5) to (200 200 0.5)
  1 by 1 by 1 MPI processor grid
create_atoms 1 random ${molecules} 12345 NULL overlap 3.9 maxtry 50
create_atoms 1 random 1000 12345 NULL overlap 3.9 maxtry 50
Created 1000 atoms
  using lattice units in orthogonal box = (0 0 -0.5) to (200 200 0.5)
  create_atoms CPU = 0.014 seconds

# --- Define the variables for lj/expand ---
variable	epsilon equal ${var_epsilon}	# energy (strength of attraction between particles)
variable	epsilon equal 0.0	
variable	sigma equal 1.0     # distance where particles bond (potential energy is 0)
variable	delta equal 0.0     # radius difference between particles (for lj/expand)
variable	cutoff equal 2.0	# cutoff distance (particles farther than this value have the interaction ignored)

# Set ellipsoid as a sphere
set type 1 shape 0.5 0.5 0.5
Setting atom values ...
  1000 settings made for shape
set atom 1 mass 1.0             # set mass of atom type 1
Setting atom values ...
  1 settings made for mass

# --- Other variables ---
variable center_x equal ${half_box}
variable center_x equal 100
variable center_y equal ${half_box}
variable center_y equal 100
variable vel_scale equal 9      # scaling factor for initial velocity magnitude (adjust if needed)
variable dist atom sqrt((x-${center_x})^2+(y-${center_y})^2)
variable dist atom sqrt((x-100)^2+(y-${center_y})^2)
variable dist atom sqrt((x-100)^2+(y-100)^2)

# --- Interactions ---
pair_style lj/expand 2.5
pair_coeff 1 1 ${epsilon} ${sigma} ${delta} ${cutoff}
pair_coeff 1 1 0 ${sigma} ${delta} ${cutoff}
pair_coeff 1 1 0 1 ${delta} ${cutoff}
pair_coeff 1 1 0 1 0 ${cutoff}
pair_coeff 1 1 0 1 0 2

# --- Initial Velocities ---
variable vx_init atom v_vel_scale*(${half_box}-x)
variable vx_init atom v_vel_scale*(100-x)
variable vy_init atom v_vel_scale*(${half_box}-y)
variable vy_init atom v_vel_scale*(100-y)
# Apply the calculated velocities to all atoms, initialize @ zero total linear momentum
velocity all set v_vx_init v_vy_init 0.0 sum yes

# --- Integration ---
fix 1 all nve
fix 2 all langevin 5.0 0.1 0.1 48279

# --- Simulation Settings ---
timestep 0.0001 # timestep for integration (in lj time units) - Keep it small for stability
thermo 100      # output thermodynamic info every 100 steps
thermo_style custom step temp pe ke etotal press vol atoms  # Added 'atoms' to check count

# --- Output ---
# dump atom positions and velocities every 100 steps to a .lammpstrj file
dump 1 all custom 100 ${filename}.lammpstrj id type x y vx vy fx fy v_dist
dump 1 all custom 100 central_pair_interaction.in_1000_0.0.lammpstrj id type x y vx vy fx fy v_dist

# --- Run Simulation ---
run 15000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.3
  ghost atom cutoff = 2.3
  binsize = 1.15, bins = 174 174 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/expand, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 10.36 | 10.36 | 10.36 Mbytes
   Step          Temp          PotEng         KinEng         TotEng         Press          Volume        Atoms   
         0   179964.67      0              269677.07      269677.07      4494.6178      40000               1000 
       100   147324.39      0              220765.6       220765.6       3679.4267      40000               1000 
       200   120608.16      0              180731.33      180731.33      3012.1888      40000               1000 
       300   98745.853      0              147970.66      147970.66      2466.1777      40000               1000 
       400   80833.906      0              121129.61      121129.61      2018.8268      40000               1000 
       500   66179.242      0              99169.594      99169.594      1652.8266      40000               1000 
       600   54183.467      0              81193.925      81193.925      1353.2321      40000               1000 
       700   44361.941      0              66476.368      66476.368      1107.9395      40000               1000 
       800   36316.899      0              54420.873      54420.873      907.01456      40000               1000 
       900   29727.824      0              44547.144      44547.144      742.4524       40000               1000 
      1000   24326.25       0              36452.886      36452.886      607.5481       40000               1000 
      1100   19916.429      0              29844.769      29844.769      497.41282      40000               1000 
      1200   16308.895      0              24438.879      24438.879      407.31464      40000               1000 
      1300   13353.281      0              20009.891      20009.891      333.49818      40000               1000 
      1400   10936.041      0              16387.658      16387.658      273.12763      40000               1000 
      1500   8958.1101      0              13423.728      13423.728      223.7288       40000               1000 
      1600   7333.3458      0              10989.019      10989.019      183.15031      40000               1000 
      1700   6006.3022      0              9000.4439      9000.4439      150.0074       40000               1000 
      1800   4921.8005      0              7375.318       7375.318       122.92197      40000               1000 
      1900   4030.6479      0              6039.9258      6039.9258      100.66543      40000               1000 
      2000   3302.5689      0              4948.8995      4948.8995      82.481659      40000               1000 
      2100   2704.6732      0              4052.9528      4052.9528      67.549214      40000               1000 
      2200   2215.8511      0              3320.4529      3320.4529      55.340881      40000               1000 
      2300   1815.2042      0              2720.0835      2720.0835      45.334726      40000               1000 
      2400   1486.6633      0              2227.765       2227.765       37.129416      40000               1000 
      2500   1220.257       0              1828.5552      1828.5552      30.475919      40000               1000 
      2600   997.68416      0              1495.0297      1495.0297      24.917162      40000               1000 
      2700   817.12053      0              1224.4551      1224.4551      20.407585      40000               1000 
      2800   669.48522      0              1003.2236      1003.2236      16.720393      40000               1000 
      2900   549.19675      0              822.97133      822.97133      13.716189      40000               1000 
      3000   450.50057      0              675.07511      675.07511      11.251252      40000               1000 
      3100   369.20931      0              553.26015      553.26015      9.2210025      40000               1000 
      3200   302.68271      0              453.57004      453.57004      7.5595007      40000               1000 
      3300   249.1969       0              373.42155      373.42155      6.2236925      40000               1000 
      3400   205.18993      0              307.47711      307.47711      5.1246186      40000               1000 
      3500   168.80046      0              252.94748      252.94748      4.2157914      40000               1000 
      3600   138.70468      0              207.84896      207.84896      3.4641493      40000               1000 
      3700   114.65893      0              171.8164       171.8164       2.8636067      40000               1000 
      3800   94.696809      0              141.90317      141.90317      2.3650528      40000               1000 
      3900   78.039734      0              116.94254      116.94254      1.9490424      40000               1000 
      4000   64.369053      0              96.457027      96.457027      1.6076171      40000               1000 
      4100   53.373688      0              79.980471      79.980471      1.3330079      40000               1000 
      4200   44.337194      0              66.439286      66.439286      1.1073214      40000               1000 
      4300   36.598978      0              54.843569      54.843569      0.91405948     40000               1000 
      4400   30.633569      0              45.904403      45.904403      0.76507339     40000               1000 
      4500   25.87345       0              38.771365      38.771365      0.64618942     40000               1000 
      4600   21.954836      0              32.899322      32.899322      0.54832203     40000               1000 
      4700   18.523979      0              27.758183      27.758183      0.46263638     40000               1000 
      4800   15.864086      0              23.772333      23.772333      0.39620555     40000               1000 
      4900   13.873856      0              20.789972      20.789972      0.34649954     40000               1000 
      5000   11.934445      0              17.883766      17.883766      0.29806276     40000               1000 
      5100   10.338176      0              15.491757      15.491757      0.25819595     40000               1000 
      5200   8.989922       0              13.471398      13.471398      0.2245233      40000               1000 
      5300   7.8123513      0              11.706808      11.706808      0.19511347     40000               1000 
      5400   6.8390801      0              10.248362      10.248362      0.17080603     40000               1000 
      5500   6.1981689      0              9.2879562      9.2879562      0.15479927     40000               1000 
      5600   5.6757718      0              8.505144       8.505144       0.1417524      40000               1000 
      5700   5.1490271      0              7.715817       7.715817       0.12859695     40000               1000 
      5800   4.7987176      0              7.1908783      7.1908783      0.11984797     40000               1000 
      5900   4.5376745      0              6.7997052      6.7997052      0.11332842     40000               1000 
      6000   4.3142248      0              6.4648659      6.4648659      0.10774776     40000               1000 
      6100   4.0376828      0              6.0504677      6.0504677      0.10084113     40000               1000 
      6200   3.8199061      0              5.7241293      5.7241293      0.095402155    40000               1000 
      6300   3.7143807      0              5.5659995      5.5659995      0.092766658    40000               1000 
      6400   3.6146637      0              5.4165735      5.4165735      0.090276225    40000               1000 
      6500   3.4811591      0              5.2165169      5.2165169      0.086941949    40000               1000 
      6600   3.3608384      0              5.0362163      5.0362163      0.083936938    40000               1000 
      6700   3.2690984      0              4.898744       4.898744       0.081645733    40000               1000 
      6800   3.2123781      0              4.8137486      4.8137486      0.080229143    40000               1000 
      6900   3.0433405      0              4.5604458      4.5604458      0.07600743     40000               1000 
      7000   2.9711165      0              4.452218       4.452218       0.074203634    40000               1000 
      7100   2.9108633      0              4.3619286      4.3619286      0.07269881     40000               1000 
      7200   2.8955183      0              4.3389342      4.3389342      0.07231557     40000               1000 
      7300   2.8362416      0              4.2501081      4.2501081      0.070835135    40000               1000 
      7400   2.7984431      0              4.1934669      4.1934669      0.069891115    40000               1000 
      7500   2.7700737      0              4.1509554      4.1509554      0.06918259     40000               1000 
      7600   2.7253595      0              4.0839513      4.0839513      0.068065855    40000               1000 
      7700   2.6877628      0              4.0276125      4.0276125      0.067126875    40000               1000 
      7800   2.7238828      0              4.0817383      4.0817383      0.068028972    40000               1000 
      7900   2.6861249      0              4.0251581      4.0251581      0.067085969    40000               1000 
      8000   2.6640347      0              3.9920559      3.9920559      0.066534266    40000               1000 
      8100   2.6439278      0              3.9619259      3.9619259      0.066032098    40000               1000 
      8200   2.6028918      0              3.9004334      3.9004334      0.065007224    40000               1000 
      8300   2.5627872      0              3.8403366      3.8403366      0.06400561     40000               1000 
      8400   2.452602       0              3.6752242      3.6752242      0.061253736    40000               1000 
      8500   2.4251544      0              3.6340938      3.6340938      0.060568231    40000               1000 
      8600   2.3461457      0              3.5156993      3.5156993      0.058594989    40000               1000 
      8700   2.3300203      0              3.4915353      3.4915353      0.058192256    40000               1000 
      8800   2.2932875      0              3.4364914      3.4364914      0.057274856    40000               1000 
      8900   2.2929623      0              3.436004       3.436004       0.057266733    40000               1000 
      9000   2.288502       0              3.4293203      3.4293203      0.057155339    40000               1000 
      9100   2.2565376      0              3.3814217      3.3814217      0.056357028    40000               1000 
      9200   2.2394638      0              3.3558365      3.3558365      0.055930608    40000               1000 
      9300   2.2074168      0              3.3078141      3.3078141      0.055130234    40000               1000 
      9400   2.1225196      0              3.1805956      3.1805956      0.053009927    40000               1000 
      9500   2.0940296      0              3.1379034      3.1379034      0.05229839     40000               1000 
      9600   2.0398241      0              3.0566763      3.0566763      0.050944606    40000               1000 
      9700   2.0273983      0              3.0380563      3.0380563      0.050634272    40000               1000 
      9800   1.9756073      0              2.9604476      2.9604476      0.049340793    40000               1000 
      9900   1.9527602      0              2.9262111      2.9262111      0.048770186    40000               1000 
     10000   1.9577119      0              2.9336313      2.9336313      0.048893854    40000               1000 
     10100   1.9113742      0              2.8641943      2.8641943      0.047736571    40000               1000 
     10200   1.8719496      0              2.8051164      2.8051164      0.04675194     40000               1000 
     10300   1.9155338      0              2.8704274      2.8704274      0.047840457    40000               1000 
     10400   1.8908723      0              2.8334721      2.8334721      0.047224535    40000               1000 
     10500   1.8236457      0              2.7327331      2.7327331      0.045545552    40000               1000 
     10600   1.7649926      0              2.6448414      2.6448414      0.04408069     40000               1000 
     10700   1.6755626      0              2.5108306      2.5108306      0.041847176    40000               1000 
     10800   1.6636132      0              2.4929244      2.4929244      0.041548741    40000               1000 
     10900   1.6290155      0              2.4410798      2.4410798      0.040684663    40000               1000 
     11000   1.5993594      0              2.3966401      2.3966401      0.039944001    40000               1000 
     11100   1.5948377      0              2.3898643      2.3898643      0.039831071    40000               1000 
     11200   1.5569415      0              2.3330768      2.3330768      0.038884614    40000               1000 
     11300   1.5285921      0              2.2905952      2.2905952      0.038176587    40000               1000 
     11400   1.4902989      0              2.2332128      2.2332128      0.037220214    40000               1000 
     11500   1.4602319      0              2.1881575      2.1881575      0.036469292    40000               1000 
     11600   1.393773       0              2.0885688      2.0885688      0.03480948     40000               1000 
     11700   1.3279235      0              1.9898934      1.9898934      0.033164891    40000               1000 
     11800   1.290964       0              1.9345096      1.9345096      0.032241827    40000               1000 
     11900   1.2767662      0              1.9132342      1.9132342      0.031887236    40000               1000 
     12000   1.2444608      0              1.8648245      1.8648245      0.031080409    40000               1000 
     12100   1.2149787      0              1.8206456      1.8206456      0.030344094    40000               1000 
     12200   1.1663888      0              1.7478336      1.7478336      0.02913056     40000               1000 
     12300   1.1463514      0              1.7178075      1.7178075      0.028630125    40000               1000 
     12400   1.0970659      0              1.6439533      1.6439533      0.027399221    40000               1000 
     12500   1.068442       0              1.6010603      1.6010603      0.026684338    40000               1000 
     12600   1.0559525      0              1.5823449      1.5823449      0.026372415    40000               1000 
     12700   1.0332211      0              1.5482818      1.5482818      0.025804696    40000               1000 
     12800   1.0053832      0              1.5065667      1.5065667      0.025109445    40000               1000 
     12900   0.96609262     0              1.4476898      1.4476898      0.024128163    40000               1000 
     13000   0.94685182     0              1.4188575      1.4188575      0.023647624    40000               1000 
     13100   0.92343139     0              1.3837619      1.3837619      0.023062699    40000               1000 
     13200   0.88296999     0              1.3231305      1.3231305      0.022052176    40000               1000 
     13300   0.84849441     0              1.2714689      1.2714689      0.021191148    40000               1000 
     13400   0.81093015     0              1.2151788      1.2151788      0.020252981    40000               1000 
     13500   0.77901785     0              1.1673582      1.1673582      0.019455971    40000               1000 
     13600   0.73987566     0              1.1087037      1.1087037      0.018478395    40000               1000 
     13700   0.69544013     0              1.042117       1.042117       0.017368617    40000               1000 
     13800   0.6711699      0              1.0057481      1.0057481      0.016762468    40000               1000 
     13900   0.64616284     0              0.96827502     0.96827502     0.016137917    40000               1000 
     14000   0.61450586     0              0.92083703     0.92083703     0.015347284    40000               1000 
     14100   0.57779398     0              0.86582429     0.86582429     0.014430405    40000               1000 
     14200   0.54113053     0              0.8108841      0.8108841      0.013514735    40000               1000 
     14300   0.51205228     0              0.76731035  