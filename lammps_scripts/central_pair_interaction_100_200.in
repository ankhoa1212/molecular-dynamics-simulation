# LAMMPS Input Script: Gradually lower velocity for atoms closer to the center

# --- Initialization ---
units lj          # Use Lennard-Jones units
atom_style ellipsoid
dimension 3       # 3D simulation
boundary f f p    # Set boundary conditions: fixed (non-periodic) in x and y, periodic in z (standard for 2D)

# --- Define the box for the simulation ---
variable box_size equal 200
variable half_box equal ${box_size}/2
region box block 0 ${box_size} 0 ${box_size} -0.5 0.5 units box # Define simulation box boundaries
create_box 1 box                     # Create the simulation box with 1 atom type
create_atoms 1 random 100 12345 NULL overlap 3.9 maxtry 50

# --- Define the variables for lj/expand ---
variable	epsilon equal 200.0	# energy (strength of attraction between particles)
variable	sigma equal 1.0		# distance where particles bond (potential energy is 0)
variable	delta equal 0.0		# radius difference between particles (for lj/expand)
variable	cutoff equal 2.0	# cutoff distance (particles greater than this have the interaction ignored)

# Set ellipsoid as a sphere
set type 1 shape 0.5 0.5 0.5
set atom 1 mass 1.0                           # Set mass of atom type 1

# --- Other variables ---
variable center_x equal ${half_box}
variable center_y equal ${half_box}
variable vel_scale equal 10              # Scaling factor for initial velocity magnitude (adjust if needed)
variable dist atom sqrt((x-${center_x})^2+(y-${center_y})^2)

# --- Interactions ---
pair_style lj/expand 2.5	
pair_coeff 1 1 ${epsilon} ${sigma} ${delta} ${cutoff}

# --- Initial Velocities --
variable vx_init atom v_vel_scale*(${half_box}-x)
variable vy_init atom v_vel_scale*(${half_box}-y)
# Apply the calculated velocities to all atoms, initializing at zero total linear momentum
velocity all set v_vx_init v_vy_init 0.0 sum yes

# --- Integration ---
fix 1 all nve
fix 2 all langevin 5.0 0.1 0.1 48279

# --- Simulation Settings ---
timestep 0.0001 # Timestep for integration (in lj time units) - Keep it small for stability
thermo 100     # Output thermodynamic info every 100 steps
thermo_style custom step temp pe ke etotal press vol atoms # Added 'atoms' to check count

# --- Output ---
# Dump atom positions and velocities every 100 steps to log.lammpstrj file
dump 1 all custom 100 central_pair_interaction.in.lammpstrj id type x y vx vy fx fy v_dist

# --- Run Simulation ---
run 25000
